\name{comoNet-package}
\alias{comoNet-package}
\alias{comoNet}
\docType{package}
\title{
  Constructing Associative Disease Co-morbidity Network from Individual-level Pregrossion Data
}
\description{
  This package provides tools to contruct disease co-morbidity network based on associative relationships among diseases. There are several different associative measures, including phi-correlation coefficient, observed-to-expected ratio (OER), and disparity filter (others to be added), that can be used to infer the existence of an edge between two diseases. Please refer to (Fotouhi, B., et al. 2018) for more comprehensive review and comparison of different methods. Note that the networks generated by current tools are associative, only informative for the observed pattern of co-morbidity, and might have some predictive ability. They are not suitable for causal interpretation that involves question regarding intervention or counterfactuals.  
}
\details{
  The detailed descriptions are included in the ?help documents for each function.
}
\author{
Ta-Chou Ng

Maintainer: Ta-Chou Ng <dachuwu@gmail.com>
}
\references{
Fotouhi, B., Momeni, N., Riolo, M. A., & Buckeridge, D. L. (2018). Statistical methods for constructing disease comorbidity networks from longitudinal inpatient data. Applied network science, 3(1), 46.

Hidalgo, C. A., Blumm, N., Barabasi, A. L., & Christakis, N. A. (2009). A dynamic network approach for the study of human phenotypes. PLoS computational biology, 5(4), e1000353.

Serrano, M. a., Boguna, M., & Vespignani, A. (2009). Extracting the multiscale backbone of complex weighted networks. Proceedings of the national academy of sciences, 106(16), 6483-6488.


}
\keyword{ package }
\seealso{
  Optional links to other man pages
}
\examples{
  \dontrun{
    
    # Convert to individual progression sequence from demo dataset
    require(comoNet)
    require(Matrix)
    head(diagnostic_data)
    ipseq <- get_ipseq(df = diagnostic_data, var_id = "ID", var_t = "ageday", 
                       var_dz = c("DZ1","DZ2","DZ3","DZ4","DZ5"))
    ipseq[1:5]
    
    
    # Construct raw progression comorbidity network 
    # from individual progression sequence
    dzLevel <- sort(unique(
      c(diagnostic_data$DZ1,diagnostic_data$DZ2, diagnostic_data$DZ3, diagnostic_data$DZ4, diagnostic_data$DZ5)
    ))
    res <- comoNet_from_prog_sp(ipseq = ipseq, dz.lv = dzLevel, bidir = F, conditional = F)
    raw_net <- res[[1]]
    image(raw_net)
    
    
    require(igraph)
    sub_net <- raw_net[1:30,1:30]
    ind <- which(rowSums(sub_net)>0 | colSums(sub_net)>0)
    sub_net <- sub_net[ind,ind]
    g1 <- graph_from_adjacency_matrix(sub_net)
    g1 <- set_vertex_attr(g1, "label", value = dzLevel[V(g1)])
    g1$layout <- layout_with_fr
    plot(g1)
    
    # Construct comorbidity network based on significant OER measure
    res <- filter_OER(as.matrix(raw_net),sig_lv = 0.05)
    OER_net <- res$A_filtered
    sub_net <- OER_net[1:30,1:30]
    ind <- which(rowSums(sub_net)>0 | colSums(sub_net)>0)
    sub_net <- sub_net[ind,ind]
    g1 <- graph_from_adjacency_matrix(sub_net)
    g1 <- set_vertex_attr(g1, "label", value = dzLevel[V(g1)])
    g1$layout <- layout_with_fr
    plot(g1)
  }
}
